votesB <- sum(dB < dA)
ties <- sum(dA == dB)
median_voter <- median(voters)
ggplot(data.frame(voters), aes(x = voters)) +
geom_histogram(bins = 60, fill = "grey80", colour = "white") +
geom_vline(xintercept = input$a, color = "#1f77b4", linewidth = 1.2) +
geom_vline(xintercept = input$b, color = "#d62728", linewidth = 1.2) +
geom_vline(xintercept = median_voter, color = "darkgreen", linetype = "dashed", linewidth = 1.2) +
geom_text(x = input$a - 0.05, y = 200, label = "Party A", color = "#1f77b4") +
geom_text(x = input$b + 0.05, y = 200, label = " Party B", color = "#d62728") +
geom_text(x = median_voter + 0.08, y = 200, label = "Median Voter", color = "darkgreen") +
labs(
title = sprintf("Vote share A: %.1f%% â€” B: %.1f%%",
100 * (votesA + 0.5 * ties)/n,
100 * (votesB + 0.5 * ties)/n),
x = "Policy space", y = "Number of voters"
) +
theme_bw()
})
}
shinyApp(ui = ui, server = server)
# set path to Figures directory
fig_dir <- here::here("03 Simulations", "Week3", "Figures")
fig_dir
# Create graph
decision_tree <- grViz("
digraph causal {
graph [ranksep = 0.6, nodesep = 0.4, fontsize = 10, rankdir = LR]
# Base style
node [fontname = 'Helvetica', fontsize = 10, style = filled, shape = box, width=1.8, height=0.8]
# Core concept
node [fillcolor = '#2C3E50', fontcolor = white, penwidth = 1.5]
Z [label = 'Political effects\\nof green subsidies']
# Short/long-term outcomes
node [fillcolor = '#E2B365', fontcolor = black]
A [label = 'Reducing opposition\\nBoosting short-term\\nPotentially unstable support']
B [label = 'Building stable\\nsupport base']
# Actors
node [fillcolor = '#B0C4DE']
a [label = 'Citizens']
b [label = 'Business']
g [label = 'New interest\\ngroups']
h [label = 'New constituencies']
# Conditional questions
node [shape = circle, fillcolor = '#90C7C1', width=1.6, height=1.2]
aa [label = 'Increased\\nsupport?']
ba [label = 'Less counter-\\nlobbying?']
aaa [label = 'No']
aab [label = 'Yes,\\nHow?']
baa [label = 'No']
bab [label = 'Yes,\\nChannels?']
# Mechanisms - soft gray-blue
node [shape = circle, fillcolor = '#C5D3D5']
aaba [label = 'Attitudinal']
aabb [label = 'Behavioural']
baba [label = 'Direct only']
babb [label = 'Direct &\\nIndirect']
ha [label = 'Electoral']
hb [label = 'Green consumers\\n(Besley & Persson)']
# Examples - refined beige
node [shape = box, fillcolor = '#F6E7C1']
aaaa [label = 'Example:\\nBelgium\\n(De Groote et al.)']
aabaa [label = 'Example:\\nLower opposition to\\nclimate reform']
aabba [label = 'Example:\\nPro-climate voting\\n(Felsenfeld et al.)']
babaa [label = 'Example:\\nSubsidies to\\ndownstream industries']
babba [label = 'Example:\\nDownstream benefit\\nfrom upstream subsidies']
hba [label = 'Example:\\nPV diffusion &\\nGreen voting']
ga [label = 'Example:\\nEEG, Feed-in Tariff\\n(Germany)']
# Edges
edge [color = '#555555', arrowsize = 0.8, fontname = 'Helvetica', fontsize = 9]
Z -> A [label = 'Short to\\nmedium term', labelangle = 0, labeldistance = 1.5]
Z -> B [label = 'Medium to\\nlong term', labelangle = 0, labeldistance = 1.5]
A -> a
A -> b
B -> g
B -> h
b -> ba
ba -> baa
ba -> bab
bab -> baba
bab -> babb
baba -> babaa
babb -> babba
a -> aa
aa -> aaa
aa -> aab
aaa -> aaaa
aab -> aaba
aab -> aabb
aaba -> aabaa
aabb -> aabba
g -> ga
h -> ha
h -> hb
ha -> hba
hb -> hba
{rank = same; A; B}
}
")
library(DiagrammeR)
# set path to Figures directory
fig_dir <- here::here("03 Simulations", "Week3", "Figures")
# Create graph
decision_tree <- grViz("
digraph causal {
graph [ranksep = 0.6, nodesep = 0.4, fontsize = 10, rankdir = LR]
# Base style
node [fontname = 'Helvetica', fontsize = 10, style = filled, shape = box, width=1.8, height=0.8]
# Core concept
node [fillcolor = '#2C3E50', fontcolor = white, penwidth = 1.5]
Z [label = 'Political effects\\nof green subsidies']
# Short/long-term outcomes
node [fillcolor = '#E2B365', fontcolor = black]
A [label = 'Reducing opposition\\nBoosting short-term\\nPotentially unstable support']
B [label = 'Building stable\\nsupport base']
# Actors
node [fillcolor = '#B0C4DE']
a [label = 'Citizens']
b [label = 'Business']
g [label = 'New interest\\ngroups']
h [label = 'New constituencies']
# Conditional questions
node [shape = circle, fillcolor = '#90C7C1', width=1.6, height=1.2]
aa [label = 'Increased\\nsupport?']
ba [label = 'Less counter-\\nlobbying?']
aaa [label = 'No']
aab [label = 'Yes,\\nHow?']
baa [label = 'No']
bab [label = 'Yes,\\nChannels?']
# Mechanisms - soft gray-blue
node [shape = circle, fillcolor = '#C5D3D5']
aaba [label = 'Attitudinal']
aabb [label = 'Behavioural']
baba [label = 'Direct only']
babb [label = 'Direct &\\nIndirect']
ha [label = 'Electoral']
hb [label = 'Green consumers\\n(Besley & Persson)']
# Examples - refined beige
node [shape = box, fillcolor = '#F6E7C1']
aaaa [label = 'Example:\\nBelgium\\n(De Groote et al.)']
aabaa [label = 'Example:\\nLower opposition to\\nclimate reform']
aabba [label = 'Example:\\nPro-climate voting\\n(Felsenfeld et al.)']
babaa [label = 'Example:\\nSubsidies to\\ndownstream industries']
babba [label = 'Example:\\nDownstream benefit\\nfrom upstream subsidies']
hba [label = 'Example:\\nPV diffusion &\\nGreen voting']
ga [label = 'Example:\\nEEG, Feed-in Tariff\\n(Germany)']
# Edges
edge [color = '#555555', arrowsize = 0.8, fontname = 'Helvetica', fontsize = 9]
Z -> A [label = 'Short to\\nmedium term', labelangle = 0, labeldistance = 1.5]
Z -> B [label = 'Medium to\\nlong term', labelangle = 0, labeldistance = 1.5]
A -> a
A -> b
B -> g
B -> h
b -> ba
ba -> baa
ba -> bab
bab -> baba
bab -> babb
baba -> babaa
babb -> babba
a -> aa
aa -> aaa
aa -> aab
aaa -> aaaa
aab -> aaba
aab -> aabb
aaba -> aabaa
aabb -> aabba
g -> ga
h -> ha
h -> hb
ha -> hba
hb -> hba
{rank = same; A; B}
}
")
library(DiagrammeR)
# set path to Figures directory
fig_dir <- here::here("03 Simulations", "Week3", "Figures")
# Create graph
decision_tree <- grViz("
digraph causal {
graph [ranksep = 0.6, nodesep = 0.4, fontsize = 10, rankdir = LR]
# Base style
node [fontname = 'Helvetica', fontsize = 10, style = filled, shape = box, width=1.8, height=0.8]
# Core concept
node [fillcolor = '#2C3E50', fontcolor = white, penwidth = 1.5]
Z [label = 'Political effects\\nof green subsidies']
# Short/long-term outcomes
node [fillcolor = '#E2B365', fontcolor = black]
A [label = 'Reducing opposition\\nBoosting short-term\\nPotentially unstable support']
B [label = 'Building stable\\nsupport base']
# Actors
node [fillcolor = '#B0C4DE']
a [label = 'Citizens']
b [label = 'Business']
g [label = 'New interest\\ngroups']
h [label = 'New constituencies']
# Conditional questions
node [shape = circle, fillcolor = '#90C7C1', width=1.6, height=1.2]
aa [label = 'Increased\\nsupport?']
ba [label = 'Less counter-\\nlobbying?']
aaa [label = 'No']
aab [label = 'Yes,\\nHow?']
baa [label = 'No']
bab [label = 'Yes,\\nChannels?']
# Mechanisms - soft gray-blue
node [shape = circle, fillcolor = '#C5D3D5']
aaba [label = 'Attitudinal']
aabb [label = 'Behavioural']
baba [label = 'Direct only']
babb [label = 'Direct &\\nIndirect']
ha [label = 'Electoral']
hb [label = 'Green consumers\\n(Besley & Persson)']
# Examples - refined beige
node [shape = box, fillcolor = '#F6E7C1']
aaaa [label = 'Example:\\nBelgium\\n(De Groote et al.)']
aabaa [label = 'Example:\\nLower opposition to\\nclimate reform']
aabba [label = 'Example:\\nPro-climate voting\\n(Felsenfeld et al.)']
babaa [label = 'Example:\\nSubsidies to\\ndownstream industries']
babba [label = 'Example:\\nDownstream benefit\\nfrom upstream subsidies']
hba [label = 'Example:\\nPV diffusion &\\nGreen voting']
ga [label = 'Example:\\nEEG, Feed-in Tariff\\n(Germany)']
# Edges
edge [color = '#555555', arrowsize = 0.8, fontname = 'Helvetica', fontsize = 9]
Z -> A [label = 'Short to\\nmedium term', labelangle = 0, labeldistance = 1.5]
Z -> B [label = 'Medium to\\nlong term', labelangle = 0, labeldistance = 1.5]
A -> a
A -> b
B -> g
B -> h
b -> ba
ba -> baa
ba -> bab
bab -> baba
bab -> babb
baba -> babaa
babb -> babba
a -> aa
aa -> aaa
aa -> aab
aaa -> aaaa
aab -> aaba
aab -> aabb
aaba -> aabaa
aabb -> aabba
g -> ga
h -> ha
h -> hb
ha -> hba
hb -> hba
{rank = same; A; B}
}
")
# Save the graph to a file
export_graph(decision_tree, file_name = file.path(fig_dir, "decision_tree.png"), file_type = "png", width = 800, height = 600)
library(rsvg)
library(DiagrammeR)
library(rsvg)
# set path to Figures directory
fig_dir <- here::here("03 Simulations", "Week3", "Figures")
# Create graph
decision_tree <- grViz("
digraph causal {
graph [ranksep = 0.6, nodesep = 0.4, fontsize = 10, rankdir = LR]
# Base style
node [fontname = 'Helvetica', fontsize = 10, style = filled, shape = box, width=1.8, height=0.8]
# Core concept
node [fillcolor = '#2C3E50', fontcolor = white, penwidth = 1.5]
Z [label = 'Political effects\\nof green subsidies']
# Short/long-term outcomes
node [fillcolor = '#E2B365', fontcolor = black]
A [label = 'Reducing opposition\\nBoosting short-term\\nPotentially unstable support']
B [label = 'Building stable\\nsupport base']
# Actors
node [fillcolor = '#B0C4DE']
a [label = 'Citizens']
b [label = 'Business']
g [label = 'New interest\\ngroups']
h [label = 'New constituencies']
# Conditional questions
node [shape = circle, fillcolor = '#90C7C1', width=1.6, height=1.2]
aa [label = 'Increased\\nsupport?']
ba [label = 'Less counter-\\nlobbying?']
aaa [label = 'No']
aab [label = 'Yes,\\nHow?']
baa [label = 'No']
bab [label = 'Yes,\\nChannels?']
# Mechanisms - soft gray-blue
node [shape = circle, fillcolor = '#C5D3D5']
aaba [label = 'Attitudinal']
aabb [label = 'Behavioural']
baba [label = 'Direct only']
babb [label = 'Direct &\\nIndirect']
ha [label = 'Electoral']
hb [label = 'Green consumers\\n(Besley & Persson)']
# Examples - refined beige
node [shape = box, fillcolor = '#F6E7C1']
aaaa [label = 'Example:\\nBelgium\\n(De Groote et al.)']
aabaa [label = 'Example:\\nLower opposition to\\nclimate reform']
aabba [label = 'Example:\\nPro-climate voting\\n(Felsenfeld et al.)']
babaa [label = 'Example:\\nSubsidies to\\ndownstream industries']
babba [label = 'Example:\\nDownstream benefit\\nfrom upstream subsidies']
hba [label = 'Example:\\nPV diffusion &\\nGreen voting']
ga [label = 'Example:\\nEEG, Feed-in Tariff\\n(Germany)']
# Edges
edge [color = '#555555', arrowsize = 0.8, fontname = 'Helvetica', fontsize = 9]
Z -> A [label = 'Short to\\nmedium term', labelangle = 0, labeldistance = 1.5]
Z -> B [label = 'Medium to\\nlong term', labelangle = 0, labeldistance = 1.5]
A -> a
A -> b
B -> g
B -> h
b -> ba
ba -> baa
ba -> bab
bab -> baba
bab -> babb
baba -> babaa
babb -> babba
a -> aa
aa -> aaa
aa -> aab
aaa -> aaaa
aab -> aaba
aab -> aabb
aaba -> aabaa
aabb -> aabba
g -> ga
h -> ha
h -> hb
ha -> hba
hb -> hba
{rank = same; A; B}
}
")
# Save the graph to a file
decision_tree %>%
export_svg() %>%
charToRaw() %>%
rsvg_png(file = file.path(fig_dir, "decision_tree.png"))
library(DiagrammeR)
library(DiagrammeRsvg)
# set path to Figures directory
fig_dir <- here::here("03 Simulations", "Week3", "Figures")
# Create graph
decision_tree <- grViz("
digraph causal {
graph [ranksep = 0.6, nodesep = 0.4, fontsize = 10, rankdir = LR]
# Base style
node [fontname = 'Helvetica', fontsize = 10, style = filled, shape = box, width=1.8, height=0.8]
# Core concept
node [fillcolor = '#2C3E50', fontcolor = white, penwidth = 1.5]
Z [label = 'Political effects\\nof green subsidies']
# Short/long-term outcomes
node [fillcolor = '#E2B365', fontcolor = black]
A [label = 'Reducing opposition\\nBoosting short-term\\nPotentially unstable support']
B [label = 'Building stable\\nsupport base']
# Actors
node [fillcolor = '#B0C4DE']
a [label = 'Citizens']
b [label = 'Business']
g [label = 'New interest\\ngroups']
h [label = 'New constituencies']
# Conditional questions
node [shape = circle, fillcolor = '#90C7C1', width=1.6, height=1.2]
aa [label = 'Increased\\nsupport?']
ba [label = 'Less counter-\\nlobbying?']
aaa [label = 'No']
aab [label = 'Yes,\\nHow?']
baa [label = 'No']
bab [label = 'Yes,\\nChannels?']
# Mechanisms - soft gray-blue
node [shape = circle, fillcolor = '#C5D3D5']
aaba [label = 'Attitudinal']
aabb [label = 'Behavioural']
baba [label = 'Direct only']
babb [label = 'Direct &\\nIndirect']
ha [label = 'Electoral']
hb [label = 'Green consumers\\n(Besley & Persson)']
# Examples - refined beige
node [shape = box, fillcolor = '#F6E7C1']
aaaa [label = 'Example:\\nBelgium\\n(De Groote et al.)']
aabaa [label = 'Example:\\nLower opposition to\\nclimate reform']
aabba [label = 'Example:\\nPro-climate voting\\n(Felsenfeld et al.)']
babaa [label = 'Example:\\nSubsidies to\\ndownstream industries']
babba [label = 'Example:\\nDownstream benefit\\nfrom upstream subsidies']
hba [label = 'Example:\\nPV diffusion &\\nGreen voting']
ga [label = 'Example:\\nEEG, Feed-in Tariff\\n(Germany)']
# Edges
edge [color = '#555555', arrowsize = 0.8, fontname = 'Helvetica', fontsize = 9]
Z -> A [label = 'Short to\\nmedium term', labelangle = 0, labeldistance = 1.5]
Z -> B [label = 'Medium to\\nlong term', labelangle = 0, labeldistance = 1.5]
A -> a
A -> b
B -> g
B -> h
b -> ba
ba -> baa
ba -> bab
bab -> baba
bab -> babb
baba -> babaa
babb -> babba
a -> aa
aa -> aaa
aa -> aab
aaa -> aaaa
aab -> aaba
aab -> aabb
aaba -> aabaa
aabb -> aabba
g -> ga
h -> ha
h -> hb
ha -> hba
hb -> hba
{rank = same; A; B}
}
")
# Save the graph to a file
decision_tree %>%
export_svg() %>%
charToRaw() %>%
rsvg_png(file = file.path(fig_dir, "decision_tree.png"))
library(DiagrammeR)
library(DiagrammeRsvg)
# set path to Figures directory
fig_dir <- here::here("03 Simulations", "Week3", "Figures")
# Create graph
decision_tree <- grViz("
digraph causal {
graph [ranksep = 0.6, nodesep = 0.4, fontsize = 10, rankdir = LR]
# Base style
node [fontname = 'Helvetica', fontsize = 10, style = filled, shape = box, width=1.8, height=0.8]
# Core concept
node [fillcolor = '#2C3E50', fontcolor = white, penwidth = 1.5]
Z [label = 'Political effects\\nof green subsidies']
# Short/long-term outcomes
node [fillcolor = '#E2B365', fontcolor = black]
A [label = 'Reducing opposition\\nBoosting short-term\\nPotentially unstable support']
B [label = 'Building stable\\nsupport base']
# Actors
node [fillcolor = '#B0C4DE']
a [label = 'Citizens']
b [label = 'Business']
g [label = 'New interest\\ngroups']
h [label = 'New constituencies']
# Conditional questions
node [shape = circle, fillcolor = '#90C7C1', width=1.6, height=1.2]
aa [label = 'Increased\\nsupport?']
ba [label = 'Less counter-\\nlobbying?']
aaa [label = 'No']
aab [label = 'Yes,\\nHow?']
baa [label = 'No']
bab [label = 'Yes,\\nChannels?']
# Mechanisms - soft gray-blue
node [shape = circle, fillcolor = '#C5D3D5']
aaba [label = 'Attitudinal']
aabb [label = 'Behavioural']
baba [label = 'Direct only']
babb [label = 'Direct &\\nIndirect']
ha [label = 'Electoral']
hb [label = 'Green consumers\\n(Besley & Persson)']
# Examples - refined beige
node [shape = box, fillcolor = '#F6E7C1']
aaaa [label = 'Example:\\nBelgium\\n(De Groote et al.)']
aabaa [label = 'Example:\\nLower opposition to\\nclimate reform']
aabba [label = 'Example:\\nPro-climate voting\\n(Felsenfeld et al.)']
babaa [label = 'Example:\\nSubsidies to\\ndownstream industries']
babba [label = 'Example:\\nDownstream benefit\\nfrom upstream subsidies']
hba [label = 'Example:\\nPV diffusion &\\nGreen voting']
ga [label = 'Example:\\nEEG, Feed-in Tariff\\n(Germany)']
# Edges
edge [color = '#555555', arrowsize = 0.8, fontname = 'Helvetica', fontsize = 9]
Z -> A [label = 'Short to\\nmedium term', labelangle = 0, labeldistance = 1.5]
Z -> B [label = 'Medium to\\nlong term', labelangle = 0, labeldistance = 1.5]
A -> a
A -> b
B -> g
B -> h
b -> ba
ba -> baa
ba -> bab
bab -> baba
bab -> babb
baba -> babaa
babb -> babba
a -> aa
aa -> aaa
aa -> aab
aaa -> aaaa
aab -> aaba
aab -> aabb
aaba -> aabaa
aabb -> aabba
g -> ga
h -> ha
h -> hb
ha -> hba
hb -> hba
{rank = same; A; B}
}
")
# Save the graph to a file
decision_tree %>%
export_svg() %>%
charToRaw() %>%
rsvg_png(file = file.path(fig_dir, "decision_tree.png"),
width = 3000,
height = 2000)
